 <div x-init="$store.modal.title = '{{ "Product" | t }}: {{ product.name }}'"></div> 
 <div x-init="$store.modal.submit = '{{ "Save" | t }}'"></div> 


<form 
    hx-post="{{ url_for('upsert_product') }}"
    hx-target="#product-list" 
    hx-ext="json-enc"
    hx-swap="innerHTML"
    x-init="
    $el.addEventListener('htmx:afterRequest', (event) => {
        if (event.detail.xhr.status === 200) {
            $store.modal.open = false;
        } else if (event.detail.xhr.status >= 400) {
            showPopup(event);
        }
    })
"
    >


    {% if product.id %}
    <!-- ID -->
    <div class="mb-2 hidden">
        <label class="block font-semibold">{{ "ID" | t }}</label>
        <input type="text" name="id" value="{{ product.id }}" class="border p-1 w-full"/>
    </div>

    {% endif %}


    {% if not product.id %}

    <div class="mb-2">
        <label class="block font-semibold">{{ "Product Type" | t }}</label>
        <select name="type_id" class="border p-1 w-full">
          {% for pid, product in products.items() %}
              <option value="{{ pid }}">
                {{ product.name }}
              </option>
          {% endfor %}
        </select>
    </div>

    {% endif %}

    <!-- Name -->
    <div class="mb-2">
        <label class="block">{{ "Name" | t }}</label>
        <input type="text" name="name" data-save="true" value="{{ product.name }}" class="border p-1 w-full"/>
    </div>

    <!-- Price -->
    <div class="mb-2">
        <label class="block">{{ "Price" | t }}</label>
        <input type="number" name="price" data-save="true" value="{{ product.price }}" class="border p-1 w-full"/>
    </div>

    <!-- Start Date -->
    <div class="mb-2">
        <label class="block">{{ "Start Date" | t }}</label>
        <input type="datetime-local" lang="sv"  name="start_date" data-save="true" value="{{ product.start_date | date() }}" class="border p-1 w-full"/>
    </div>

    <!-- End Date -->
    <div class="mb-2">
        <label class="block">{{ "End Date" | t }}</label>
        <input type="datetime-local" lang="sv"  name="end_date" data-save="true" value="{{ product.end_date | date() }}" class="border p-1 w-full"/>
    </div>

    <!-- Description -->
    <div class="mb-2">
        <label class="block">{{ "Description" | t }}</label>
        <textarea name="description" data-save="true" class="border p-1 w-full">{{ product.description }}</textarea>
    </div>

<!-- Product Types -->
<fieldset class="mb-2 border p-2">
  <legend class="font-bold">{{ "Product Types" | t }}</legend>

  <label>
    <input type="hidden" name="type_a" value="false">
    <input type="checkbox" name="type_a" value="true" {% if product.type_a %}checked{% endif %}/> {{ "Parties" | t }}
  </label><br/>

  <label>
    <input type="hidden" name="type_b" value="false">
    <input type="checkbox" name="type_b" value="true" {% if product.type_b %}checked{% endif %}/> {{ "AW" | t }}
  </label><br/>

  <label>
    <input type="hidden" name="type_c" value="false">
    <input type="checkbox" name="type_c" value="true" {% if product.type_c %}checked{% endif %}/> {{ "Lectures" | t }}
  </label><br/>

  <label>
    <input type="hidden" name="type_d" value="false">
    <input type="checkbox" name="type_d" value="true" {% if product.type_d %}checked{% endif %}/> {{ "Activism" | t }}
  </label><br/>

  <label>
    <input type="hidden" name="type_e" value="false">
    <input type="checkbox" name="type_e" value="true" {% if product.type_e %}checked{% endif %}/> {{ "Conferences" | t }}
  </label>
</fieldset>

<!-- Extra Options -->
<fieldset class="mb-2 border p-2">
  <legend class="font-bold">{{ "Extra Options" | t }}</legend>

  <label>
    <input type="hidden" name="extra_external" value="false">
    <input type="checkbox" name="extra_external" value="true" {% if product.extra_external %}checked{% endif %}/> {{ "External" | t }}
  </label><br/>

  <label>
    <input type="hidden" name="extra_non_political" value="false">
    <input type="checkbox" name="extra_non_political" value="true" {% if product.extra_non_political %}checked{% endif %}/> {{ "Non-Political" | t }}
  </label><br/>

  <label>
    <input type="hidden" name="extra_visilble_all" value="false">
    <input type="checkbox" name="extra_visilble_all" value="true" {% if product.extra_visilble_all %}checked{% endif %}/> {{ "Visible to All" | t }}
  </label>
</fieldset>

    <!-- Submit 
    <div class="flex justify-end mt-4">   
        <button type="submit" class="px-3 py-1 bg-blue-500 text-white rounded">{{ "Save" | t }}</button>
    </div>
    -->
</form>
