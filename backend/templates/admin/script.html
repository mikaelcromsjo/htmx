<h1 class="text-2xl font-bold mb-6">Adminscript</h1>

<div class="grid grid-cols-2 gap-6">
  <!-- Left: Script form -->
  <form 
      hx-post="/admin/script"
      hx-target="#admin_content"
      hx-swap="innerHTML"
      class="bg-white p-4 rounded-xl shadow-md space-y-4"
  >
    <!-- Script selection -->
    <div>
      <label class="block font-semibold mb-1">Script:</label>
      <select id="script-select" name="script_name" class="border rounded p-2 w-full">
        {% for key, path in scripts.items() %}
          <option value="{{ key }}">{{ key }}</option>
        {% endfor %}
      </select>
    </div>

    <!-- Arguments input -->
    <div>
      <label class="block font-semibold mb-1">Argument:</label>
      <input 
        type="text" 
        name="args" 
        placeholder="Enter arguments..." 
        class="border rounded p-2 w-full" 
      />
    </div>

    <!-- Submit -->
<button 
  class="px-3 py-1 border rounded bg-gray-100 hover:bg-gray-200"
>
  KÃ¶r
</button>  </form>

  <!-- Right: Examples and output -->
  <div class="space-y-4">
    <!-- Examples -->
    <div class="bg-white p-4 rounded-xl shadow-md">
      <label class="block font-semibold mb-2">Exampel:</label>
      <textarea 
        id="examples-textarea" 
        class="border rounded p-2 w-full font-mono text-sm" 
        rows="8" 
        readonly
      ></textarea>
    </div>
  </div>



<!-- Preload all examples in JSON -->
<script type="application/json" id="script-examples-data">
{{ script_examples | tojson }}
</script>

<script>
  const scriptData = JSON.parse(document.getElementById('script-examples-data').textContent);
  const examplesTextarea = document.getElementById('examples-textarea');
  const scriptSelect = document.getElementById('script-select');

  function updateExamples(scriptKey) {
    const examples = scriptData[scriptKey] || [];
    // If your examples are objects with "args", use: examples.map(e => e.args).join("\n")
    examplesTextarea.value = examples.join("\n");
  }

  // Initialize textarea on page load
  updateExamples(scriptSelect.value);

  // Update textarea automatically when selection changes
  scriptSelect.addEventListener('change', () => {
    updateExamples(scriptSelect.value);
  });
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const scriptData = JSON.parse(document.getElementById('script-examples-data').textContent);
  const examplesTextarea = document.getElementById('examples-textarea');
  const scriptSelect = document.getElementById('script-select');

  function updateExamples(scriptKey) {
    const examples = scriptData[scriptKey] || [];
    examplesTextarea.value = examples.join("\n");
  }

  updateExamples(scriptSelect.value);
  scriptSelect.addEventListener('change', () => updateExamples(scriptSelect.value));
});
</script>
