<div class="container-fluid border">
    <!-- Row 1 -->
    <div class="row border-bottom" style="height: 40vh;">
        <!-- Customers Column -->
        <div class="col-md-3 border-end p-3 d-flex flex-column" style="height:100%;">
            <div class="fw-semibold">Customers</div>
            <div id="customer-list" class="flex-grow-1 overflow-auto mt-2" x-data="{ selectedCustomer: null }">
                {% for customer in customers %}
                <div class="p-2 border-bottom cursor-pointer" :class="{
                        'bg-success bg-opacity-25 fw-bold text-success': selectedCustomer === {{ customer.id }},
                        'bg-white fw-normal text-dark': selectedCustomer !== {{ customer.id }}
                     }" @click="selectedCustomer = {{ customer.id }}"
                    hx-get="{{ url_for('customer_detail', customer_id=customer.id) }}?list=short"
                    hx-target="#customer-info">
                    {{ customer.first_name }}
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Customer Info Column -->
        <div class="col-md-3 border-end p-3 d-flex flex-column" style="height:100%;">
            <div class="fw-semibold">Customer Info</div>
            <div id="customer-info" class="flex-grow-1 overflow-auto mt-2 p-2 border" style="background:#f8f9fa;">
                {% for info in customer_details %}
                <div class="p-1">{{ info }}</div>
                {% endfor %}
            </div>

            <div class="mt-2">
                Comment
                <textarea class="form-control mt-1" x-model="$store.customer.comment" rows="3"></textarea>
            </div>
        </div>

        <!-- Events Column -->
        <div class="col-md-3 border-end p-3 d-flex flex-column" style="height:100%;">
            <div class="fw-semibold">Events</div>
            <div id="call-events" class="flex-grow-1 overflow-auto mt-2">
                <div id="call-event-list">
                    <div x-data="{
                        isVisible(event) {
                            let filters = Alpine.store('eventFilters');
                            if (!filters) return true;
                            return Object.keys(filters).some(type => filters[type] && event[type]);
                        }
                    }">
                        <div id="event-list" x-data="{ selectedEvent: null }">
                            {% for event in events %}
                            <div x-show="isVisible({ 
                                activism: {{ 'true' if event.type_activism else 'false' }},
                                lecture: {{ 'true' if event.type_lecture else 'false' }},
                                parties: {{ 'true' if event.type_parties else 'false' }},
                                politics: {{ 'true' if event.type_politics else 'false' }}
                            })" class="p-2 border-bottom cursor-pointer" :class="{
                                'bg-primary bg-opacity-25 fw-bold text-primary': selectedEvent === {{ event.id }},
                                'bg-white fw-normal text-dark': selectedEvent !== {{ event.id }}
                            }" @click="selectedEvent = {{ event.id }}"
                                hx-get="{{ url_for('event_detail', event_id=event.id) }}?list=short"
                                hx-target="#event-info">
                                {{ event.name }}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Event Info Column -->
        <div class="col-md-3 border-end p-3 d-flex flex-column" style="height:100%;">
            <div class="fw-semibold">Event Info</div>
            <div id="event-info" class="flex-grow-1 overflow-auto mt-2 p-2 border" style="background:#f8f9fa;"></div>
        </div>
    </div>

    <!-- Row 2 -->
    <div class="row" style="height:40vh;">
        <div class="col-md-3 border-end p-3 d-flex flex-column" style="height:100%;">
            Calls
            <div class="flex-grow-1 overflow-auto mt-2 border p-2" style="background:#f8f9fa;">
                <!-- Calls content goes here -->
            </div>
        </div>

        <div class="col-md-3 border-end p-3 d-flex flex-column" style="height:100%;">
            Call Info
            <div class="flex-grow-1 overflow-auto mt-2 border p-2" style="background:#f8f9fa;">
                <!-- Call Info content goes here -->
            </div>
        </div>

        <div class="col-md-6 border-end p-3 d-flex flex-column" style="height:100%;">
            <!-- Filters -->
            <div class="d-flex flex-wrap gap-2 p-2 mb-3 border rounded bg-light">
                <template x-for="(value, type) in Alpine.store('eventFilters')" :key="type">
                    <label class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" x-model="Alpine.store('eventFilters')[type]">
                        <span x-text="type.charAt(0).toUpperCase() + type.slice(1)"></span>
                    </label>
                </template>
            </div>
            <!-- Event Options -->
            <div class="d-flex flex-wrap gap-2 p-2 mb-3 border rounded bg-light">
                    <label class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" x-model="Alpine.store('eventFilters')[type]">
                        <span x-text="type.charAt(0).toUpperCase() + type.slice(1)">Parties</span>
                    </label>                
            </div>

            Call Comment
            <div>
                <textarea class="form-control mb-2" x-model="$store.customer.comment" rows="3"></textarea>
            </div>
            <div>
                <!-- Call Button -->
                <button class="btn btn-primary me-2 mb-2">Call</button>

                <!-- Option Selector -->
                <select class="form-select d-inline-block w-auto me-2 mb-2">
                    <option value="answered">answered</option>
                    <option value="no-answer">no answer</option>
                    <option value="wrong-person">wrong person</option>
                </select>

                <!-- Save Button -->
                <button class="btn btn-success mb-2">Save</button>
            </div>
            <div class="flex-grow-1 overflow-auto mt-2 border p-2" style="background:#f8f9fa;">
                <!-- Additional scrollable content if needed -->
            </div>
        </div>
    </div>
</div>

<script defer>
    Alpine.store('eventFilters', {
        activism: true,
        lecture: true,
        parties: true,
        politics: true
    });

    Alpine.store('customer', {
        comment: ""
    });
</script>